[options]
# Database Configuration
db_host = ${DB_HOST}
db_port = ${DB_PORT}
db_user = ${DB_USER}
db_password = ${DB_PASSWORD}
db_name = ${DB_NAME}
db_template = template0
db_maxconn = ${ODOO_DB_MAXCONN}
db_sslmode = ${ODOO_DB_SSLMODE}
dbfilter = ^odoo_.*$

# Server Configuration
http_port = 8069
http_interface = 0.0.0.0
proxy_mode = true
trusted_proxy_ips = *

# Paths
addons_path = /usr/lib/python3/dist-packages/odoo/addons,/mnt/extra-addons
data_dir = /var/lib/odoo

# Logging
log_level = ${ODOO_LOG_LEVEL}
log_handler = :INFO

# Workers
workers = ${ODOO_WORKERS}
max_cron_threads = ${ODOO_MAX_CRON_THREADS}
gevent_port = 8072
longpolling_port = 8072

# Security
admin_passwd = ${ODOO_ADMIN_PASSWORD}
list_db = ${ODOO_LIST_DB}
csrf_protection = True

# Server-wide modules
server_wide_modules = base,web,sentry,auth_api_key,dbfilter_from_header

# Performance Limits
limit_memory_hard = ${ODOO_LIMIT_MEMORY_HARD}
limit_memory_soft = ${ODOO_LIMIT_MEMORY_SOFT}
limit_request = ${ODOO_LIMIT_REQUEST}
limit_time_cpu = ${ODOO_LIMIT_TIME_CPU}
limit_time_real = ${ODOO_LIMIT_TIME_REAL}
limit_time_real_cron = -1

# Sentry Error Tracking
sentry_enabled = ${SENTRY_ENABLED}
sentry_dsn = ${SENTRY_DSN}
sentry_environment = ${SENTRY_ENVIRONMENT}
sentry_logging_level = warn
sentry_exclude_loggers = werkzeug
sentry_ignore_exceptions = odoo.exceptions.AccessDenied,odoo.exceptions.AccessError,odoo.exceptions.MissingError,odoo.exceptions.RedirectWarning,odoo.exceptions.UserError,odoo.exceptions.ValidationError,odoo.exceptions.Warning,odoo.exceptions.except_orm
sentry_include_context = true
sentry_odoo_dir = /usr/lib/python3/dist-packages/odoo

# R2 Cloud Storage
[fs_storage.r2_odoo]
protocol = s3
options = {"endpoint_url": "${R2_ENDPOINT}", "key": "${R2_ACCESS_KEY_ID}", "secret": "${R2_SECRET_ACCESS_KEY}"}
directory_path = ${R2_BUCKET_UPLOADS}/odoo
